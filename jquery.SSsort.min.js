(function(a){a.extend({SSsort:new function(){function e(j){j.pagecount=((j.rows.length/j.pagesize)|0)+1}function d(k,j){if(j.currentid){a("#"+j.currentid).html(j.currentpage)}var m=k+parseInt(j.pagesize,10);var n=j.rows;for(var l=0;l<n.length;l++){n[l].style.display=(l>=k&&l<m)?"":"none"}}function f(s){var m=s.works[s.sortcol];var j=m.parser.format;var u=s.rows;var q=u.length;var t=s.sortcol;var o=[];var n;for(var r=0;r<q;r++){n=u[r].cells[t];o[r]=[j(c(n),n,s),r]}var k;if(m.parser.type=="text"){k=(s.sortdesc)?function(v,l){return(l[0].localeCompare(v[0]))}:function(v,l){return(v[0].localeCompare(l[0]))}}else{k=(s.sortdesc)?function(v,l){return(l[0]-v[0])}:function(v,l){return(v[0]-l[0])}}m._map=o.sort(k)}function i(q){var n=q.data;if(n.rows.length<2){return}var k=this.cellIndex;var v=n.header.find("tr:first > th");var j=0;if(k>0){for(var m=0;m<k;m++){var u=v[m];if(u.hasAttribute("colspan")){var t=u.getAttribute("colspan");j+=parseInt(t,10)||1}else{j++}}}var r=null;if(j==n.sortcol){var o=(n.sortdesc)?n.descClass:n.ascClass;n.sortdesc=!n.sortdesc;var s=(n.sortdesc)?n.descClass:n.ascClass;if(o){v.eq(j).removeClass(o)}if(s){v.eq(j).addClass(s)}a(n.table).trigger("beforetablesort",{column:j,direction:n.sortdesc});if(n.works[j].dirty){f(n)}else{n.works[j]._map.reverse()}}else{if(n.sortcol!==null){r=n.sortcol;o=(n.sortdesc)?n.descClass:n.ascClass;if(o){v.eq(r).removeClass(o)}if(n.sortClass){v.eq(r).addClass(n.sortClass)}if(n.ascClass){v.eq(j).addClass(n.ascClass)}n.sortdesc=false}else{if(n.sortClass){v.eq(j).removeClass(n.sortClass)}s=(n.sortdesc)?n.descClass:n.ascClass;if(s){v.eq(j).addClass(s)}}n.sortcol=j;a(n.table).trigger("beforetablesort",{column:j,direction:n.sortdesc});f(n)}setTimeout(function(){var C=(n.oddClass)?new RegExp("(^|\\s+)"+n.oddClass+"(?!\\S)"):false;var G=(n.evenClass)?new RegExp("(^|\\s+)"+n.evenClass+"(?!\\S)"):false;var F=(n.oddClass)?new RegExp("(^|\\s+)"+n.oddsortClass+"(?!\\S)"):false;var w=(n.evenClass)?new RegExp("(^|\\s+)"+n.evensortClass+"(?!\\S)"):false;var D=n.body[0];var H=D.parentNode;var K=D.nextSibling;var J=n.rows;var y=J.length;var x=n.works[j]._map;var I,E,A,z;H.removeChild(D);for(var B=0;B<y;B++){A=x[B][1];I=J[A];u=I.cells[j];D.appendChild(I);if(B%2){if(C){I.className=I.className.replace(C,"")}if(G&&!I.className.match(G)){I.className=I.className+" "+n.evenClass}if(F){u.className=u.className.replace(F,"")}if(w&&!u.className.match(w)){u.className=u.className+" "+n.evensortClass}}else{if(G){I.className=I.className.replace(G,"")}if(C&&!I.className.match(C)){I.className=I.className+" "+n.oddClass}if(w){u.className=u.className.replace(w,"")}if(F&&!u.className.match(F)){u.className=u.className+" "+n.oddsortClass}}if(r!==null){E=I.cells[r];if(F){E.className=E.className.replace(F,"")}if(w){E.className=E.className.replace(w,"")}}x[B][1]=B;for(z=B+1;z<y;z++){if(x[z][1]>A){x[z][1]--}}}H.insertBefore(D,K);n.body=a(n.table).children("tbody");n.rows=D.rows;n.works[j].dirty=(typeof(n.works[j].parser.watch)!=="undefined"&&n.works[j].parser.watch);if(n.paginate){n.currentpage=1;e(n);d(0,n);if(n.countid){a("#"+n.countid).html(n.pagecount)}}a(n.table).trigger("aftertablesort",{column:j,direction:n.sortdesc});a.isFunction(n.onSorted)&&n.onSorted.call(n.table)},20)}function c(k){while(k.hasChildNodes()){k=k.firstChild}var j=k.nodeValue;return(j)?j:false}function b(t,n){var r=false,j,v=n.rows,q=0,u;while(r===false){u=v[q];if(u){j=u.cells[t];r=a.trim(c(j))}else{break}q++}var s=a.SSsort.parsers;if(r!==false){var o=a.SSsort.ipcount,k=s.length;for(var m=o;m<k;m++){if(s[m].is(r,j,n)){return s[m]}}for(m=1;m<o;m++){if(s[m].is(r,j,n)){return s[m]}}}return s[0]}function h(m){var o=a.SSsort.parsers,q=a.SSsort.ipcount,j=o.length,k=m.toLowerCase();for(var n=q;n<j;n++){if(o[n].id.toLowerCase()==k){return o[n]}}for(n=0;n<q;n++){if(o[n].id.toLowerCase()==k){return o[n]}}return false}function g(m,j){var n=false;if(a.metadata){var l=a(m).metadata().sss;if(l===false){return false}else{if(l){n=h(l)}}}if(!n){var k=m.cellIndex;n=b(k,j)}return n}this.defaults={sortClass:null,ascClass:null,descClass:null,evenClass:null,oddClass:null,evensortClass:null,oddsortClass:null,firstsort:null,sortdesc:false,paginate:false,pagesize:20,currentid:null,countid:null,onSorted:null};this.parsers=[{id:"text",is:function(j){return true},format:function(j){return a.trim(j)},type:"text"},{id:"number",is:function(j){return(!isNaN(parseFloat(j))&&isFinite(j))},format:function(j){if(j){var k=Number(j);return(isNaN(k))?Number.NEGATIVE_INFINITY:k}else{if((j+"").length>0){return 0}else{return Number.POSITIVE_INFINITY}}},type:"numeric"},{id:"isoDate",is:function(j){p=/^[12]\d{3}[\/-][01]\d[\/-]\[0-3]\d$/;return p.test(j)},format:function(j){return Date.parse(j.replace(/-/g,"/"))},type:"numeric"}];this.ipcount=this.parsers.length;this.construct=function(j){var k={table:null,header:null,body:null,rows:null,sortcol:null,sortdata:[],currentpage:1,pagecount:1,works:[]};this.each(function(){var m={};a.extend(m,k,a.SSsort.defaults,j||{});a.data(this,"SSsortcfg",m);m.table=this;var q=a(this);m.header=q.children("thead");m.body=q.children("tbody");m.rows=m.body[0].rows;var l=m.header.find("tr:first > th");var o=a.fn.jquery;var n=0;l.each(function(){var r=a(this);if(!r.hasClass("nosort")){var s=g(this,m);if(s){m.works[n]={parser:s,dirty:true,_map:[]};if(m.rows.length>1&&m.sortClass){r.addClass(m.sortClass)}if(o>="1.7"){r.on("click.sss",m,i)}else{r.bind("click.sss",m,i)}}}n++});if(m.firstsort!==null){$cell=l.eq(m.firstsort-1);if(!$cell.hasClass("nosort")){$cell.trigger("click")}else{m.firstsort=null}}if(m.firstsort===null&&m.paginate){e(m);d(0,m);if(m.countid){a("#"+m.countid).html(m.pagecount)}}});return this};this.movePage=function(l,n,k){var j=a.data(l,"SSsortcfg");if(j){var m=(n)?((k)?j.pagecount:j.currentpage+1):((k)?1:j.currentpage-1);if(m>0&&m<=j.pagecount){j.currentpage=m;d((m-1)*j.pagesize,j)}}};this.mapTable=function(l){var j={};var k=1;a(l).find("tr").each(function(){var m=this.getAttribute("id")||this.getAttribute("name")||"row"+k;var o={};var n=1;a(this).each(function(){var r=[];a(this).children().each(function(){r[r.length]=(this.hasAttribute("value"))?this.getAttribute("value"):a(this).text()});var t=this.atgetAttribute("id")||this.getAttribute("name")||"col"+n;switch(r.length){case 0:o[t]="<empty>";break;case 1:o[t]=r[0];break;default:var s={};for(var q=0;q<r.length;++q){s[q]=r[q]}o[t]=s;break}n++});j[m]=o;k++});return j};this.addParser=function(q,o){var n=q.id.toLowerCase();var m=a.SSsort.parsers;var j=m.length;for(var k=0;k<j;k++){if(m[k].id.toLowerCase()==n){if(o){m[k]=q}return}}m[j]=q};this.formatFloat=function(j){var k=parseFloat(j);return(isNaN(k))?Number.NEGATIVE_INFINITY:k};this.formatInt=function(j){var k=parseInt(j,10);return(isNaN(k))?Number.NEGATIVE_INFINITY:k}}});a.fn.extend({SSsort:a.SSsort.construct})})(jQuery);